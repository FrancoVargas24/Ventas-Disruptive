<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://use.typekit.net/mdk5yrn.css">
  <link rel="stylesheet" href="https://use.typekit.net/mdk5yrn.css">
  <link rel="stylesheet" href="css/style.css">
  <title>Registro de Ventas de Stickers</title>
</head>

<body>

  </div>
  <h1 style="font-family: 'bebas neue', sans-serif;">BUSCADOR</h1>

  <!-- Agregar dentro del <body> -->
  <div style="margin: 30px 0;display: flex;justify-content: center;">
    <input type="text" id="buscador" placeholder="Codigo del sticker..."
      style="padding:8px; width: 250px; font-size: 1.1em;">
  </div>
  <div id="resultados" style="display: flex; flex-wrap: wrap; gap: 16px;justify-content: center;"></div>

  <script>
    const stickersFolder = 'stickers/';
    let listaStickers = [];

    // Cargar la lista de archivos JSON
    fetch('json/0todos.json')
      .then(res => res.json())
      .then(archivos => {
        // Para cada archivo, cargar su contenido (que es un array de nombres de imágenes)
        const promesas = archivos.map(nombre =>
          fetch('json/' + nombre)
            .then(res => res.json())
            .catch(() => []) // Si algún archivo falla, lo ignora
        );
        // Esperar a que todos los archivos se carguen
        Promise.all(promesas).then(arrays => {
          // Unir todos los arrays en uno solo
          listaStickers = arrays.flat();
          mostrarResultados('');
        });
      });

    function mostrarResultados(filtro) {
      const resultados = document.getElementById('resultados');
      resultados.innerHTML = '';
      const filtroLower = filtro.trim().toLowerCase();

      let filtrados = listaStickers.filter(nombre =>
        nombre.toLowerCase().includes(filtroLower)
      );

      // Si el filtro está vacío, mostrar solo los primeros 100
      if (filtroLower === '') {
        filtrados = filtrados.slice(0, 100);
      }

      if (filtrados.length === 0) {
        resultados.innerHTML = '<p>No se encontraron stickers.</p>';
        return;
      }

      filtrados.forEach(nombre => {
        const div = document.createElement('div');
        div.style.textAlign = 'center';
        div.innerHTML = `
      <img src="${stickersFolder}${nombre}" alt="${nombre}" style="width:100px; height:auto; display:block; margin-bottom:4px;">
    `;
        resultados.appendChild(div);
      });
    }

    document.getElementById('buscador').addEventListener('input', function () {
      mostrarResultados(this.value);
    });

    // Abrir el menú al tocar el logo
    document.getElementById("abrirMenu").addEventListener("click", function () {
      document.getElementById("sidebar").classList.add("visible");
    });

    // Cerrar el menú
    function cerrarMenu() {
      document.getElementById("sidebar").classList.remove("visible");
    }

    document.addEventListener("click", function (event) {
      const sidebar = document.getElementById("sidebar");
      const logo = document.getElementById("abrirMenu");

      if (
        sidebar.classList.contains("visible") &&
        !sidebar.contains(event.target) &&
        event.target !== logo
      ) {
        cerrarMenu();
      }
    });

    // Cargar lista de imágenes (de un JSON generado previamente)
    fetch('json/0todos.json')
      .then(res => res.json())
      .then(data => {
        listaStickers = data;
        mostrarResultados('');
      });


  </script>
</body>

</html>